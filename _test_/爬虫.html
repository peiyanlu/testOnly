<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>é“¾æ¥é¢„è§ˆ Demo</title>
  <style>
    .preview-box {
      position: absolute;
      background: #FFFFFF;
      border: 1px solid #CCCCCC;
      padding: 12px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      max-width: 300px;
      display: none;
      z-index: 9999;
      font-family: sans-serif;
    }
    
    .preview-box h4 {
      margin: 0 0 6px;
      font-size: 16px;
    }
    
    .preview-box p {
      margin: 0;
      font-size: 13px;
      color: #555555;
    }
  </style>
</head>
<body>
<h2>é¼ æ ‡æ‚¬åœæŸ¥çœ‹é“¾æ¥ä¿¡æ¯</h2>
<p>
  ğŸ‘‰ <a href="https://peiyanlu.github.io/vite-press/" class="preview-link">VitePress ä¸»é¡µ</a>
</p>

<div id="previewBox" class="preview-box"></div>

<script>
  const previewBox = document.getElementById('previewBox');
  let hoverTimer = null;
  
  // æ‚¬åœå¤„ç†
  document.querySelectorAll('.preview-link').forEach(link => {
    link.addEventListener('mouseenter', async (e) => {
      const href = link.href;
      const rect = link.getBoundingClientRect();
      
      // è®¾ç½®æµ®çª—ä½ç½®
      previewBox.style.left = rect.left + 'px';
      previewBox.style.top = (rect.bottom + 8 + window.scrollY) + 'px';
      previewBox.style.display = 'block';
      previewBox.innerHTML = 'åŠ è½½ä¸­...';
      
      // å–æ¶ˆä¹‹å‰çš„è®¡æ—¶å™¨
      if (hoverTimer) clearTimeout(hoverTimer);
      
      try {
        const res = await fetch(href, { mode: 'cors' });
        const html = await res.text();
        const doc = new DOMParser().parseFromString(html, 'text/html');
        
        const title = doc.querySelector('title')?.innerText || 'æ— æ ‡é¢˜';
        const desc = doc.querySelector('meta[name="description"]')?.content || 'æ— æè¿°ä¿¡æ¯';
        
        previewBox.innerHTML = `
            <h4>${ title }</h4>
            <p>${ desc }</p>
          `;
      } catch (err) {
        previewBox.innerHTML = `<p>âŒ è·å–å¤±è´¥ï¼š${ err.message }</p>`;
      }
    });
    
    link.addEventListener('mouseleave', () => {
      // å»¶è¿Ÿéšè—ï¼Œé¿å…ç”¨æˆ·çªç„¶ç§»å‡º
      hoverTimer = setTimeout(() => {
        previewBox.style.display = 'none';
      }, 300);
    });
    
    previewBox.addEventListener('mouseenter', () => {
      if (hoverTimer) clearTimeout(hoverTimer); // ç”¨æˆ·ç§»å…¥æµ®çª—ï¼Œä¿æŒæ˜¾ç¤º
    });
    
    previewBox.addEventListener('mouseleave', () => {
      previewBox.style.display = 'none';
    });
  });
</script>
</body>
</html>
